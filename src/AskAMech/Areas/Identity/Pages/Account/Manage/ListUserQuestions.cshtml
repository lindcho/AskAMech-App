@page
@using AskAMech.Domain
@model AskAMech.Areas.Identity.Pages.Account.Manage.ListUserQuestionsModel
@{
    IEnumerable<Question> questions = ViewData["Questions"] as IEnumerable<Question>;
    var enumQuestions = questions as Question[] ?? (questions ?? throw new InvalidOperationException("Questions not found")).ToArray();
    IEnumerable<AnswersListViewModel> answers = ViewData["Answers"] as IEnumerable<AnswersListViewModel>;
    var answersListViewModels = answers as AnswersListViewModel[] ?? (answers ?? throw new InvalidOperationException("answers not found")).ToArray();
}

@{
    ViewData["Title"] = "List User Questions";
    ViewData["ActivePage"] = ManageNavPages.ListUserQuestions;
}

<h4>@ViewData["Title"]</h4>

<div class="container bootstrap snippet">
    <div class="row col-lg-9">
        <ul class="nav nav-tabs" id="myTab">
            <li class="active"><a href="#home" data-toggle="tab">Home</a></li>
            <li><a href="#answers" data-toggle="tab">Answers</a></li>
        </ul>

        <div class="tab-content">
            <div class="tab-pane active" id="home">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                        <tr>
                            <th>Title</th>
                            <th>Description</th>
                            <th>DateCreated</th>
                            <th>LastModified</th>
                        </tr>
                        </thead>

                        @foreach (Question question in enumQuestions)
                        {
                            <tbody id="items">
                            <tr>
                                <td>@question.Title</td>
                                <td>@question.Description</td>
                                <td>@question.DateCreated.ToString("yyyy/MM/dd")</td>
                                <td>@question.LastModified.ToString("yyyy/MM/dd")</td>
                            </tr>
                            </tbody>
                        }
                    </table>
                    <hr>
                    <div class="row">
                        <div class="col-md-4 col-md-offset-4 text-center">
                            <ul class="pagination" id="myPager"></ul>
                        </div>
                    </div>
                </div>
                <hr>
            </div>
        </div>
        

        <div class="tab-content">
            <div class="tab-pane" id="answers">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Questions I have Asked</th>
                            </tr>
                        </thead>

                        @foreach (Question question in enumQuestions)
                        {
                           
                            <tbody id="items">
                                <tr>
                                    <td  style="background-color: lightgray">@question.Description</td>
                                </tr>
                            </tbody>
                            <thead>
                                <tr>
                                    <th>Answer/s</th>
                                    <th>Date answered</th>
                                </tr>
                            </thead>
                            foreach (var answer in answersListViewModels)
                            {
                                if (answer.QuestionId == question.Id)
                                {
                                    <tbody id="items">
                                    <tr>
                                        <td >@answer.AnswerDescription</td>
                                        <td >@answer.DateAnswered.ToString("yyyy/MM/dd")</td>
                                    </tr>
                                    </tbody>
                                }
                            }
                        }

                    </table>   

                </div>
            </div>
        </div> 
    </div>
</div>
